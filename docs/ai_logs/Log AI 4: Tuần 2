User

user_id (PK)

name

email

password

Shop

shop_id (PK)

shop_name

owner_id (FK â†’ User)

Product

product_id (PK)

shop_id (FK)

name

price

ProductVariant

variant_id (PK)

product_id (FK)

size

color

stock_quantity

Order

order_id (PK)

user_id (FK)

total_amount

order_date

OrderItem

order_item_id (PK)

order_id (FK)

variant_id (FK)

quantity

price

Voucher

voucher_id (PK)

code

discount_value

min_order_amount 
phÃ¢n tÃ­ch quan há»‡ trÃªn
Ráº¥t tá»‘t Vinh ğŸ‘Œ, báº¡n Ä‘Ã£ mÃ´ táº£ má»™t mÃ´ hÃ¬nh cÆ¡ sá»Ÿ dá»¯ liá»‡u thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ khÃ¡ chuáº©n. MÃ¬nh sáº½ phÃ¢n tÃ­ch quan há»‡ giá»¯a cÃ¡c báº£ng Ä‘á»ƒ báº¡n tháº¥y rÃµ cáº¥u trÃºc vÃ  logic:

ğŸ§‘ User
user_id (PK): khÃ³a chÃ­nh Ä‘á»‹nh danh ngÆ°á»i dÃ¹ng.

Má»™t User cÃ³ thá»ƒ:

Sá»Ÿ há»¯u nhiá»u Shop (quan há»‡ 1â€“N vá»›i báº£ng Shop).

Äáº·t nhiá»u Order (quan há»‡ 1â€“N vá»›i báº£ng Order).

ğŸ¬ Shop
shop_id (PK): khÃ³a chÃ­nh Ä‘á»‹nh danh cá»­a hÃ ng.

owner_id (FK â†’ User): liÃªn káº¿t Ä‘áº¿n ngÆ°á»i dÃ¹ng sá»Ÿ há»¯u shop.

Má»™t Shop cÃ³ thá»ƒ:

CÃ³ nhiá»u Product (quan há»‡ 1â€“N vá»›i báº£ng Product).

ğŸ“¦ Product
product_id (PK): khÃ³a chÃ­nh Ä‘á»‹nh danh sáº£n pháº©m.

shop_id (FK â†’ Shop): sáº£n pháº©m thuá»™c vá» má»™t shop.

Má»™t Product cÃ³ thá»ƒ:

CÃ³ nhiá»u ProductVariant (quan há»‡ 1â€“N vá»›i báº£ng ProductVariant).

ğŸ¨ ProductVariant
variant_id (PK): khÃ³a chÃ­nh Ä‘á»‹nh danh biáº¿n thá»ƒ sáº£n pháº©m.

product_id (FK â†’ Product): biáº¿n thá»ƒ thuá»™c vá» má»™t sáº£n pháº©m.

Má»—i biáº¿n thá»ƒ cÃ³ thuá»™c tÃ­nh riÃªng: size, color, stock_quantity.

Má»™t ProductVariant cÃ³ thá»ƒ:

Xuáº¥t hiá»‡n trong nhiá»u OrderItem (quan há»‡ 1â€“N vá»›i báº£ng OrderItem).

ğŸ§¾ Order
order_id (PK): khÃ³a chÃ­nh Ä‘á»‹nh danh Ä‘Æ¡n hÃ ng.

user_id (FK â†’ User): Ä‘Æ¡n hÃ ng thuá»™c vá» má»™t ngÆ°á»i dÃ¹ng.

Má»™t Order cÃ³ thá»ƒ:

Chá»©a nhiá»u OrderItem (quan há»‡ 1â€“N vá»›i báº£ng OrderItem).

ğŸ“‘ OrderItem
order_item_id (PK): khÃ³a chÃ­nh Ä‘á»‹nh danh chi tiáº¿t Ä‘Æ¡n hÃ ng.

order_id (FK â†’ Order): chi tiáº¿t thuá»™c vá» má»™t Ä‘Æ¡n hÃ ng.

variant_id (FK â†’ ProductVariant): chi tiáº¿t gáº¯n vá»›i má»™t biáº¿n thá»ƒ sáº£n pháº©m.

Thá»ƒ hiá»‡n má»‘i quan há»‡ Nâ€“N giá»¯a Order vÃ  ProductVariant, Ä‘Æ°á»£c giáº£i quyáº¿t qua báº£ng trung gian OrderItem.

ğŸŸ Voucher
voucher_id (PK): khÃ³a chÃ­nh Ä‘á»‹nh danh voucher.

Thuá»™c tÃ­nh: code, discount_value, min_order_amount.

CÃ³ thá»ƒ Ã¡p dá»¥ng cho Order (quan há»‡ tiá»m nÄƒng 1â€“N hoáº·c Nâ€“N tÃ¹y thiáº¿t káº¿).

Náº¿u má»™t Ä‘Æ¡n hÃ ng chá»‰ dÃ¹ng 1 voucher â†’ thÃªm voucher_id (FK) trong báº£ng Order.

Náº¿u má»™t Ä‘Æ¡n hÃ ng cÃ³ thá»ƒ dÃ¹ng nhiá»u voucher â†’ cáº§n báº£ng trung gian OrderVoucher.

ğŸ“Š TÃ³m táº¯t quan há»‡
User â€“ Shop: 1â€“N

Shop â€“ Product: 1â€“N

Product â€“ ProductVariant: 1â€“N

User â€“ Order: 1â€“N

Order â€“ OrderItem â€“ ProductVariant: Nâ€“N (qua OrderItem)

Order â€“ Voucher: 1â€“N hoáº·c Nâ€“N (tÃ¹y yÃªu cáº§u nghiá»‡p vá»¥)

ğŸ‘‰ ÄÃ¢y lÃ  má»™t ERD logic cho há»‡ thá»‘ng e-commerce cÆ¡ báº£n. Náº¿u tháº§y há»i, báº¡n cÃ³ thá»ƒ nháº¥n máº¡nh:

OrderItem lÃ  báº£ng trung gian Ä‘á»ƒ giáº£i quyáº¿t quan há»‡ Nâ€“N giá»¯a Order vÃ  ProductVariant.

Voucher cáº§n xem xÃ©t nghiá»‡p vá»¥: má»™t Ä‘Æ¡n hÃ ng cÃ³ thá»ƒ Ã¡p dá»¥ng má»™t hay nhiá»u voucher.

Báº¡n cÃ³ muá»‘n mÃ¬nh váº½ sÆ¡ Ä‘á»“ ERD (Entity Relationship Diagram) trá»±c quan cho mÃ´ hÃ¬nh nÃ y Ä‘á»ƒ dá»… hÃ¬nh dung hÆ¡n khÃ´ng?

(FK â†’ User) chá»— khÃºc nÃ y tÃ´i váº«n chÆ°a hiá»ƒu láº¯m, á»Ÿ shop cÃ³ owner_id nhÆ°ng á»Ÿ user Ä‘Ã¢u cÃ³ owner_id thÃ¬ lÃ m sao lÃ m FK Ä‘c
Ã€, mÃ¬nh hiá»ƒu chá»— báº¡n Ä‘ang tháº¯c máº¯c rá»“i Vinh ğŸ‘. Äá»ƒ mÃ¬nh giáº£i thÃ­ch rÃµ:

ğŸ”‘ NguyÃªn táº¯c vá» Foreign Key (FK)
Foreign Key (FK) khÃ´ng cáº§n pháº£i cÃ³ cÃ¹ng tÃªn vá»›i cá»™t á»Ÿ báº£ng tham chiáº¿u.

FK chá»‰ cáº§n tham chiáº¿u Ä‘áº¿n Primary Key (PK) hoáº·c má»™t cá»™t duy nháº¥t (Unique) cá»§a báº£ng khÃ¡c.

ğŸ¬ TrÆ°á»ng há»£p cá»§a báº¡n
Báº£ng User cÃ³ user_id (PK).

Báº£ng Shop cÃ³ owner_id (FK â†’ User).

ğŸ‘‰ Äiá»u nÃ y nghÄ©a lÃ :

owner_id trong báº£ng Shop sáº½ tham chiáº¿u Ä‘áº¿n user_id trong báº£ng User.

Tá»©c lÃ  má»—i shop pháº£i cÃ³ má»™t chá»§ sá»Ÿ há»¯u (owner), vÃ  ngÆ°á»i Ä‘Ã³ chÃ­nh lÃ  má»™t User trong há»‡ thá»‘ng.

ğŸ“Š VÃ­ dá»¥ minh há»a
User table

user_id	name	email
1	Vinh	vinh@email.com
2	Lan	lan@email.com
Shop table

shop_id	shop_name	owner_id
101	Vinh Store	1
102	Lan Boutique	2
ğŸ‘‰ á» Ä‘Ã¢y:

owner_id = 1 â†’ tham chiáº¿u Ä‘áº¿n user_id = 1 (Vinh lÃ  chá»§ shop 101).

owner_id = 2 â†’ tham chiáº¿u Ä‘áº¿n user_id = 2 (Lan lÃ  chá»§ shop 102).

âœ… Káº¿t luáº­n
Báº¡n khÃ´ng cáº§n cÃ³ cá»™t owner_id trong báº£ng User.

Chá»‰ cáº§n cÃ³ user_id (PK) trong báº£ng User, vÃ  owner_id (FK) trong báº£ng Shop tham chiáº¿u Ä‘áº¿n Ä‘Ã³.

TÃªn cá»™t cÃ³ thá»ƒ khÃ¡c nhau, miá»…n lÃ  FK trá» Ä‘Ãºng vá» PK/Unique cá»§a báº£ng kia.

Báº¡n cÃ³ muá»‘n mÃ¬nh váº½ sÆ¡ Ä‘á»“ ERD trá»±c quan (cÃ¡c báº£ng vÃ  mÅ©i tÃªn quan há»‡) Ä‘á»ƒ dá»… hÃ¬nh dung hÆ¡n khÃ´ng?

trong cÃ¡i báº£ng quan há»‡, theo suy Ä‘oÃ¡n cá»§a tui lÃ  trÆ°á»ng OrderItem Ã¡ cÃ³ mÃ£ item nÃ¨, cÃ³ mÃ£ Ä‘Æ¡n vÃ  cÃ¡i mÃ£ Ä‘a dáº¡ng Ä‘Ã³ Ä‘á»ƒ cÃ³ thá»ƒ suy ra mÃ£ sáº£n pháº©m nÃªn trong Ä‘Ã³ ko cáº§n thÃªm mÃ£ sáº£n pháº©m nx Ä‘Ãºng ko
ÄÃºng rá»“i Vinh, báº¡n suy luáº­n ráº¥t chuáº©n ğŸ‘Œ. MÃ¬nh phÃ¢n tÃ­ch ká»¹ hÆ¡n Ä‘á»ƒ báº¡n tháº¥y rÃµ:

ğŸ§¾ Báº£ng OrderItem
order_item_id (PK) â†’ Ä‘á»‹nh danh chi tiáº¿t Ä‘Æ¡n hÃ ng.

order_id (FK â†’ Order) â†’ biáº¿t chi tiáº¿t nÃ y thuá»™c Ä‘Æ¡n hÃ ng nÃ o.

variant_id (FK â†’ ProductVariant) â†’ biáº¿t chi tiáº¿t nÃ y lÃ  biáº¿n thá»ƒ nÃ o cá»§a sáº£n pháº©m.

quantity, price â†’ sá»‘ lÆ°á»£ng vÃ  giÃ¡ táº¡i thá»i Ä‘iá»ƒm Ä‘áº·t.

ğŸ”— Quan há»‡ logic
ProductVariant Ä‘Ã£ cÃ³ product_id (FK â†’ Product).

VÃ¬ váº­y, khi báº¡n cÃ³ variant_id, báº¡n hoÃ n toÃ n cÃ³ thá»ƒ truy ngÆ°á»£c ra product_id vÃ  tá»« Ä‘Ã³ biáº¿t sáº£n pháº©m gá»‘c.

Do Ä‘Ã³, trong OrderItem khÃ´ng cáº§n thÃªm cá»™t product_id ná»¯a, vÃ¬ sáº½ bá»‹ dÆ° thá»«a dá»¯ liá»‡u (redundant).

ğŸ“Š VÃ­ dá»¥ minh há»a
ProductVariant table

variant_id	product_id	size	color
501	1001	M	Red
502	1001	L	Blue
OrderItem table

order_item_id	order_id	variant_id	quantity	price
9001	7001	501	2	200
ğŸ‘‰ Tá»« variant_id = 501 â†’ biáº¿t product_id = 1001.
KhÃ´ng cáº§n lÆ°u thÃªm product_id trong OrderItem, vÃ¬ Ä‘Ã£ cÃ³ thá»ƒ suy ra qua ProductVariant.

âœ… Káº¿t luáº­n
Trong OrderItem, chá»‰ cáº§n order_id vÃ  variant_id.

product_id khÃ´ng cáº§n thiáº¿t vÃ¬ Ä‘Ã£ cÃ³ thá»ƒ truy ngÆ°á»£c qua variant_id.

ÄÃ¢y lÃ  cÃ¡ch thiáº¿t káº¿ chuáº©n hÃ³a dá»¯ liá»‡u (normalization) Ä‘á»ƒ trÃ¡nh dÆ° thá»«a vÃ  Ä‘áº£m báº£o tÃ­nh nháº¥t quÃ¡n.

Báº¡n cÃ³ muá»‘n mÃ¬nh giáº£i thÃ­ch thÃªm vá» chuáº©n hÃ³a dá»¯ liá»‡u (database normalization) vÃ  táº¡i sao thiáº¿t káº¿ nhÆ° váº­y giÃºp há»‡ thá»‘ng e-commerce dá»… má»Ÿ rá»™ng, trÃ¡nh lá»—i khi cáº­p nháº­t khÃ´ng?
