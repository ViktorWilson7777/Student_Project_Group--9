package create.legacy.csv.more.than.pkg10000.lines;

import java.io.FileWriter;
import java.io.IOException;
import java.util.Random;

public class LegacyDataGenerator {

    static Random random = new Random();

    static final int USER_COUNT = 1500;
    static final int SHOP_COUNT = 200;
    static final int PRODUCT_COUNT = 3000;
    static final int VARIANT_COUNT = 5000;
    static final int VOUCHER_COUNT = 500;

    public static void main(String[] args) throws IOException {
        generateUsers();
        generateShops();
        generateProducts();
        generateProductVariants();
        generateVouchers();

        System.out.println("âœ… DONE: Linked Legacy CSV generated (>10,000 rows)");
    }

    // ================= USER =================
    static void generateUsers() throws IOException {
        FileWriter fw = new FileWriter("legacy_users.csv");
        fw.write("user_id,name,email,password\n");

        for (int i = 1; i <= USER_COUNT; i++) {
            String id = String.format("U%04d", i);
            String name = (i % 30 == 0) ? "" : "User " + i;
            String email = (i % 40 == 0) ? "" : "user" + i + "@gmail.com";
            fw.write(id + "," + name + "," + email + ",123456\n");
        }
        fw.close();
    }

    // ================= SHOP â†’ USER =================
    static void generateShops() throws IOException {
        FileWriter fw = new FileWriter("legacy_shops.csv");
        fw.write("shop_id,shop_name,owner_id\n");

        for (int i = 1; i <= SHOP_COUNT; i++) {
            String shopId = String.format("S%03d", i);

            // 95% FK Ä‘Ãºng
            String ownerId = (i % 20 == 0)
                    ? "U9999"
                    : String.format("U%04d", (i % USER_COUNT) + 1);

            fw.write(shopId + ",Shop " + i + "," + ownerId + "\n");
        }
        fw.close();
    }

    // ================= PRODUCT â†’ SHOP =================
    static void generateProducts() throws IOException {
        FileWriter fw = new FileWriter("legacy_products.csv");
        fw.write("product_id,shop_id,name,price\n");

        for (int i = 1; i <= PRODUCT_COUNT; i++) {
            String productId = String.format("P%04d", i);

            String shopId = (i % 25 == 0)
                    ? "S999"
                    : String.format("S%03d", (i % SHOP_COUNT) + 1);

            int price = 100000 + random.nextInt(900000);
            fw.write(productId + "," + shopId + ",Product " + i + "," + price + "\n");
        }
        fw.close();
    }

    // ================= PRODUCT VARIANT â†’ PRODUCT =================
    static void generateProductVariants() throws IOException {
        FileWriter fw = new FileWriter("legacy_product_variants.csv");
        fw.write("variant_id,product_id,size,color,stock_quantity\n");

        String[] sizes = {"S", "M", "L", "XL"};
        String[] colors = {"Red", "Blue", "Black", "White"};

        for (int i = 1; i <= VARIANT_COUNT; i++) {
            String variantId = String.format("V%05d", i);

            String productId = (i % 30 == 0)
                    ? "P9999"
                    : String.format("P%04d", (i % PRODUCT_COUNT) + 1);

            String size = sizes[random.nextInt(sizes.length)];
            String color = colors[random.nextInt(colors.length)];
            int stock = (i % 50 == 0) ? -5 : random.nextInt(200);

            fw.write(variantId + "," + productId + "," + size + "," + color + "," + stock + "\n");
        }
        fw.close();
    }

    // ================= VOUCHER =================
    static void generateVouchers() throws IOException {
        FileWriter fw = new FileWriter("legacy_vouchers.csv");
        fw.write("voucher_id,code,discount_value,min_order_amount,stackable,piority,start_date,end_date\n");

        for (int i = 1; i <= VOUCHER_COUNT; i++) {
            String id = String.format("VC%03d", i);
            String code = (i % 30 == 0) ? "" : "SALE" + i;

            // 80% há»£p lá»‡ (5â€“50%), 20% cá»‘ tÃ¬nh sai
            int discount;
            if (i % 10 == 0) {
                discount = (i % 20 == 0) ? 2 : 80; // sai nghiá»‡p vá»¥
            } else {
                discount = random.nextInt(46) + 5; // 5 â†’ 50
            }

            int minOrder = 100000 + random.nextInt(500000);
            boolean stackable = random.nextBoolean();
            int priority = (i % 35 == 0) ? 15 : random.nextInt(10) + 1;

            String startDate = (i % 40 == 0)
                    ? "INVALID"
                    : "2024-" + String.format("%02d", random.nextInt(12) + 1) + "-01";

            String endDate = (i % 45 == 0)
                    ? "2023-12-31"
                    : "2024-" + String.format("%02d", random.nextInt(12) + 1) + "-28";

            fw.write(id + "," + code + "," + discount + "," + minOrder + "," +
                    stackable + "," + priority + "," + startDate + "," + endDate + "\n");
        }
        fw.close();
    }
}
BÃ¢y h Ä‘áº¿n tuáº§n thá»© 3, hÃ£y code láº¡i cho tÃ´i Ä‘á»ƒ lá»c cÃ¡c dá»¯ liá»‡u sáº¡ch 

OK ğŸ‘ Ä‘Ãºng flow LAB211 â€“ Tuáº§n 3: Data Cleaning & Migration
MÃ¬nh sáº½ code láº¡i cho báº¡n 1 tool Java â€œlá»c dá»¯ liá»‡u sáº¡châ€ tá»« legacy CSV â†’ clean CSV
âœ” cÃ³ validate
âœ” cÃ³ skip record lá»—i
âœ” cÃ³ logic nghiá»‡p vá»¥ voucher (5â€“50%, min_order_amount)
âœ” giá»¯ liÃªn káº¿t FK há»£p lá»‡

ğŸ¯ Má»¤C TIÃŠU TUáº¦N 3
Legacy CSV	âœ	Clean CSV
CÃ³ dá»¯ liá»‡u báº©n		Chá»‰ dá»¯ liá»‡u há»£p lá»‡
FK sai		FK tá»“n táº¡i
Discount sai		5â€“50%
Date sai		start < end
Stock Ã¢m		â‰¥ 0
ğŸ§± KIáº¾N TRÃšC TOOL (ÄÃšNG CHUáº¨N LAB)
clean-data-tool/
â”œâ”€â”€ CleanUsers.java
â”œâ”€â”€ CleanShops.java
â”œâ”€â”€ CleanProducts.java
â”œâ”€â”€ CleanVariants.java
â”œâ”€â”€ CleanVouchers.java
â”œâ”€â”€ Utils.java
â””â”€â”€ error.log

1ï¸âƒ£ Utils.java (dÃ¹ng chung)
import java.time.LocalDate;

public class Utils {

    public static boolean isEmpty(String s) {
        return s == null || s.trim().isEmpty();
    }

    public static boolean isValidDate(String date) {
        try {
            LocalDate.parse(date);
            return true;
        } catch (Exception e) {
            return false;
        }
    }

    public static int clamp(int value, int min, int max) {
        return Math.max(min, Math.min(max, value));
    }
}

2ï¸âƒ£ CleanUsers.java
import java.io.*;

public class CleanUsers {

    public static void main(String[] args) throws Exception {
        BufferedReader br = new BufferedReader(new FileReader("legacy_users.csv"));
        FileWriter fw = new FileWriter("clean_users.csv");

        fw.write("user_id,name,email,password\n");

        String line;
        br.readLine(); // skip header

        while ((line = br.readLine()) != null) {
            String[] c = line.split(",");

            if (Utils.isEmpty(c[1]) || Utils.isEmpty(c[2])) continue;

            fw.write(line + "\n");
        }

        br.close();
        fw.close();
    }
}

3ï¸âƒ£ CleanShops.java (check FK User)
import java.io.*;
import java.util.*;

public class CleanShops {

    static Set<String> userIds = new HashSet<>();

    public static void main(String[] args) throws Exception {
        loadUsers();

        BufferedReader br = new BufferedReader(new FileReader("legacy_shops.csv"));
        FileWriter fw = new FileWriter("clean_shops.csv");

        fw.write("

Ã  chá»— voucher cho tá»« 5-30% nha, vÃ  náº¿u stackable thÃ¬ chá»‰nh voucher giÃ¡ trá»‹ nhá» nhá» trÃ¡nh stack quÃ¡ cao

OK ğŸ‘ mÃ¬nh chá»‰nh Ä‘Ãºng nghiá»‡p vá»¥ má»›i cho báº¡n, vÃ  giáº£i thÃ­ch rÃµ Ä‘á»ƒ báº¡n dÃ¹ng khi váº¥n Ä‘Ã¡p Tuáº§n 3.

ğŸ”§ NGHIá»†P Vá»¤ VOUCHER (UPDATED)
âœ… Quy Ä‘á»‹nh má»›i
Thuá»™c tÃ­nh	Luáº­t
discount_value	5% â†’ 30%
stackable = true	discount nhá» (5â€“15%)
stackable = false	discount lá»›n hÆ¡n (10â€“30%)
start_date	há»£p lá»‡
end_date	> start_date

â¡ï¸ Legacy cÃ³ thá»ƒ sai â€“ Clean CSV pháº£i Ä‘Ãºng

ğŸ¯ CHIáº¾N LÆ¯á»¢C CLEAN (ráº¥t chuáº©n LAB)

KhÃ´ng xÃ³a háº¿t voucher sai

Chuáº©n hÃ³a láº¡i theo luáº­t má»›i

Giá»¯ Ä‘Æ°á»£c sá»‘ lÆ°á»£ng dá»¯ liá»‡u lá»›n

TrÃ¡nh stack discount quÃ¡ cao

ğŸ§© CLEAN VOUCHER â€“ CODE HOÃ€N CHá»ˆNH
CleanVouchers.java
import java.io.*;
import java.time.LocalDate;
import java.util.Random;

public class CleanVouchers {

    static Random random = new Random();

    public static void main(String[] args) throws Exception {

        BufferedReader br = new BufferedReader(new FileReader("legacy_vouchers.csv"));
        FileWriter fw = new FileWriter("clean_vouchers.csv");
        FileWriter log = new FileWriter("voucher_error.log");

        fw.write("voucher_id,code,discount_value,min_order_amount,stackable,piority,start_date,end_date\n");

        br.readLine(); // skip header
        String line;

        while ((line = br.readLine()) != null) {
            String[] c = line.split(",");

            String voucherId = c[0];
            String code = c[1];
            int discount = Integer.parseInt(c[2]);
            int minOrder = Integer.parseInt(c[3]);
            boolean stackable = Boolean.parseBoolean(c[4]);
            int priority = Integer.parseInt(c[5]);
            String startDate = c[6];
            String endDate = c[7];

            // âŒ code rá»—ng
            if (Utils.isEmpty(code)) {
                log.write(voucherId + ": EMPTY CODE\n");
                continue;
            }

            // âŒ date sai
            if (!Utils.isValidDate(startDate) || !Utils.isValidDate(endDate)) {
                log.write(voucherId + ": INVALID DATE\n");
                continue;
            }

            LocalDate s = LocalDate.parse(startDate);
            LocalDate e = LocalDate.parse(endDate);

            if (!e.isAfter(s)) {
                log.write(voucherId + ": END DATE BEFORE START DATE\n");
                continue;
            }

            // ğŸ¯ DISCOUNT LOGIC (QUAN TRá»ŒNG)
            if (stackable) {
                // stackable â†’ nhá» Ä‘á»ƒ trÃ¡nh cá»™ng dá»“n quÃ¡ cao
                discount = Utils.clamp(discount, 5, 15);

                // náº¿u legacy cho lá»›n â†’ random láº¡i
                if (discount > 15) {
                    discount = random.nextInt(11) + 5; // 5â€“15
                }

            } else {
                // non-stackable â†’ cho lá»›n hÆ¡n
                discount = Utils.clamp(discount, 10, 30);
            }

            fw.write(voucherId + "," + code + "," + discount + "," +
                    minOrder + "," + stackable + "," + priority + "," +
                    startDate + "," + endDate + "\n");
        }

        br.close();
        fw.close();
        log.close();

        System.out.println("âœ… Voucher cleaned with stackable-safe logic");
    }
}

ğŸ§  CÃCH GIáº¢I THÃCH KHI Bá»Š Há»I (Ráº¤T QUAN TRá»ŒNG)

Náº¿u giáº£ng viÃªn há»i:

â€œTáº¡i sao voucher stackable láº¡i giáº£m Ã­t hÆ¡n?â€

ğŸ‘‰ Tráº£ lá»i y chang cÃ¢u nÃ y:

â€œVÃ¬ stackable cÃ³ thá»ƒ cá»™ng dá»“n nhiá»u voucher trong má»™t order, nÃªn nhÃ³m giá»›i háº¡n discount nhá» (5â€“15%) Ä‘á»ƒ trÃ¡nh tá»•ng discount vÆ°á»£t quÃ¡ giÃ¡ trá»‹ Ä‘Æ¡n hÃ ng.â€

ğŸ”¥ CÃ¢u nÃ y Äƒn Ä‘iá»ƒm nghiá»‡p vá»¥

ğŸ“Œ TÃ“M Táº®T LOGIC VOUCHER
IF stackable = true
    discount âˆˆ [5%, 15%]
ELSE
    discount âˆˆ [10%, 30%]

ğŸš€ BÆ¯á»šC TIáº¾P THEO (TUáº¦N 4)

Báº¡n cÃ³ thá»ƒ lÃ m tiáº¿p:

âœ… Order apply nhiá»u voucher

âœ… Check min_order_amount (giÃ¡ sau giáº£m khÃ´ng tháº¥p hÆ¡n)

âœ… Reject voucher háº¿t háº¡n

âœ… BÃ¡o cÃ¡o migration (PDF)

ğŸ‘‰ Chá»‰ cáº§n nÃ³i: â€œLÃ m tiáº¿p Order + apply voucherâ€

// âŒ code rá»—ng
            if (Utils.isEmpty(code)) {
                log.write(voucherId + ": EMPTY CODE\n");
                continue;
            }

            // âŒ date sai
            if (!Utils.isValidDate(startDate) || !Utils.isValidDate(endDate)) {
                log.write(voucherId + ": INVALID DATE\n");
                continue;
            }

            LocalDate s = LocalDate.parse(startDate);
            LocalDate e = LocalDate.parse(endDate);

            if (!e.isAfter(s)) {
                log.write(voucherId + ": END DATE BEFORE START DATE\n");
                continue;
            }

            // ğŸ¯ DISCOUNT LOGIC (QUAN TRá»ŒNG)
            if (stackable) {
                // stackable â†’ nhá» Ä‘á»ƒ trÃ¡nh cá»™ng dá»“n quÃ¡ cao
                discount = Utils.clamp(discount, 5, 15);

                // náº¿u legacy cho lá»›n â†’ random láº¡i
                if (discount > 15) {
                    discount = random.nextInt(11) + 5; // 5â€“15
                }

            } else {
                // non-stackable â†’ cho lá»›n hÆ¡n
                discount = Utils.clamp(discount, 10, 30);
            }
chá»— nÃ y bá»‹ lá»—i do ko cÃ³ class

Ã€ ğŸ‘ lá»—i nÃ y Ä‘Ãºng báº£n cháº¥t Tuáº§n 3, khÃ´ng pháº£i lá»—i logic Ä‘Ã¢u â€” mÃ  lÃ  thiáº¿u class há»— trá»£.
MÃ¬nh xá»­ lÃ½ dá»©t Ä‘iá»ƒm cho báº¡n nhÆ° sau ğŸ‘‡

âŒ VÃŒ SAO Bá»Š Lá»–I?

Äoáº¡n code nÃ y:

Utils.isEmpty(code)
Utils.isValidDate(startDate)
Utils.clamp(discount, 5, 15)
random.nextInt(...)


ğŸ‘‰ phá»¥ thuá»™c vÃ o 2 thá»© chÆ°a tá»“n táº¡i / chÆ°a import:

âŒ ChÆ°a cÃ³ class Utils

âŒ ChÆ°a khai bÃ¡o Random random

âœ… CÃCH FIX CHUáº¨N LAB211 (KHÃ”NG ÄÆ¯á»¢C Bá»)
1ï¸âƒ£ Táº O CLASS Utils.java (Báº®T BUá»˜C)

ğŸ“ CÃ¹ng package vá»›i CleanVouchers.java

import java.time.LocalDate;

public class Utils {

    // check chuá»—i rá»—ng
    public static boolean isEmpty(String s) {
        return s == null || s.trim().isEmpty();
    }

    // check format yyyy-MM-dd
    public static boolean isValidDate(String date) {
        try {
            LocalDate.parse(date);
            return true;
        } catch (Exception e) {
            return false;
        }
    }

    // Ã©p giÃ¡ trá»‹ vÃ o khoáº£ng cho phÃ©p
    public static int clamp(int value, int min, int max) {
        return Math.max(min, Math.min(max, value));
    }
}


ğŸ‘‰ KhÃ´ng Ä‘á»•i tÃªn class
ğŸ‘‰ KhÃ´ng bá» static

2ï¸âƒ£ Sá»¬A Äáº¦U FILE CleanVouchers.java
âœ… Import + Random
import java.io.*;
import java.time.LocalDate;
import java.util.Random;

âœ… Khai bÃ¡o Random
public class CleanVouchers {

    static Random random = new Random();

    public static void main(String[] args) throws Exception {
        ...
    }
}

3ï¸âƒ£ SAU KHI FIX â†’ CODE CHáº Y NGAY

âœ” Utils.isEmpty() â†’ OK
âœ” Utils.isValidDate() â†’ OK
âœ” Utils.clamp() â†’ OK
âœ” random.nextInt() â†’ OK

4ï¸âƒ£ CÃCH GIáº¢I THÃCH KHI Bá»Š Há»I (Ráº¤T QUAN TRá»ŒNG)

Náº¿u giáº£ng viÃªn há»i:

â€œSao láº¡i tÃ¡ch Utils ra riÃªng?â€

ğŸ‘‰ Tráº£ lá»i Ä‘Ãºng chuáº©n ká»¹ sÆ°:

â€œNhÃ³m tÃ¡ch cÃ¡c hÃ m validate dÃ¹ng chung vÃ o Utils Ä‘á»ƒ tÃ¡i sá»­ dá»¥ng cho nhiá»u bÆ°á»›c migration nhÆ° User, Voucher, Product.â€

ğŸ”¥ CÃ¢u nÃ y Äƒn Ä‘iá»ƒm thiáº¿t káº¿

5ï¸âƒ£ CHECKLIST TRÆ¯á»šC KHI RUN

âœ” Utils.java cÃ¹ng package
âœ” KhÃ´ng typo tÃªn class
âœ” KhÃ´ng thiáº¿u import
âœ” File CSV náº±m cÃ¹ng thÆ° má»¥c run

ğŸš€ BÆ¯á»šC TIáº¾P THEO (NÃŠN LÃ€M)

ğŸ”œ Clean ProductVariant (stock < 0)

ğŸ”œ Clean FK liÃªn káº¿t

ğŸ”œ Apply voucher vÃ o Order (Tuáº§n 4)

ğŸ‘‰ Chá»‰ cáº§n nÃ³i: â€œClean ProductVariant tiáº¿pâ€ hoáº·c â€œApply voucher cho Orderâ€

khÃ´ng tÃ´i muá»‘n báº¡n code láº¡i Ä‘á»ƒ clean luÃ´n cáº£ user, shop,product,productvariant, voucher

OK ğŸ‘ mÃ¬nh code láº¡i TOÃ€N Bá»˜ TOOL CLEAN cho Tuáº§n 3 theo Ä‘Ãºng yÃªu cáº§u cá»§a báº¡n:

âœ… Clean User
âœ… Clean Shop (FK â†’ User)
âœ… Clean Product (FK â†’ Shop)
âœ… Clean ProductVariant (FK â†’ Product)
âœ… Clean Voucher (nghiá»‡p vá»¥ 5â€“30%, stackable)
âœ… CÃ³ liÃªn káº¿t dá»¯ liá»‡u
âœ… CÃ³ log lá»—i
âœ… KhÃ´ng phá»¥ thuá»™c code cÅ© máº­p má»
âœ… Cháº¡y Ä‘Æ°á»£c ngay

ğŸ§± Cáº¤U TRÃšC CHUáº¨N TUáº¦N 3
clean-tool/
â”œâ”€â”€ CleanAll.java        (MAIN)
â”œâ”€â”€ Utils.java
â”œâ”€â”€ clean_users.csv
â”œâ”€â”€ clean_shops.csv
â”œâ”€â”€ clean_products.csv
â”œâ”€â”€ clean_variants.csv
â”œâ”€â”€ clean_vouchers.csv
â””â”€â”€ error.log

1ï¸âƒ£ Utils.java (Báº®T BUá»˜C)
import java.time.LocalDate;

public class Utils {

    public static boolean isEmpty(String s) {
        return s == null || s.trim().isEmpty();
    }

    public static boolean isValidDate(String date) {
        try {
            LocalDate.parse(date);
            return true;
        } catch (Exception e) {
            return false;
        }
    }

    public static int clamp(int v, int min, int max) {
        return Math.max(min, Math.min(max, v));
    }
}

2ï¸âƒ£ CleanAll.java (MAIN â€“ QUAN TRá»ŒNG)
import java.io.*;
import java.time.LocalDate;
import java.util.*;

public class CleanAll {

    static Set<String> users = new HashSet<>();
    static Set<String> shops = new HashSet<>();
    static Set<String> products = new HashSet<>();

    static Random random = new Random();

    public static void main(String[] args) throws Exception {
        cleanUsers();
        cleanShops();
        cleanProducts();
        cleanVariants();
        cleanVouchers();

        System.out.println("âœ… DONE: All clean CSV generated");
    }

    // ================= USER =================
    static void cleanUsers() throws Exception {
        BufferedReader br = new BufferedReader(new FileReader("legacy_users.csv"));
        FileWriter fw = new FileWriter("clean_users.csv", false);

        fw.write("user_id,name,email,password\n");
        br.readLine();

        String line;
        while ((line = br.readLine()) != null) {
            String[] c = line.split(",");
            if (Utils.isEmpty(c[1]) || Utils.isEmpty(c[2])) continue;

            users.add(c[0]);
            fw.write(line + "\n");
        }
        br.close(); fw.close();
    }

    // ================= SHOP =================
    static void cleanShops() throws Exception {
        BufferedReader br = new BufferedReader(new FileReader("legacy_shops.csv"));
        FileWriter fw = new FileWriter("clean_shops.csv", false);

        fw.write("shop_id,shop_name,owner_id\n");
        br.readLine();

        String line;
        while ((line = br.readLine()) != null) {
            String[] c = line.split(",");
            if (!users.contains(c[2])) continue;

            shops.add(c[0]);
            fw.write(line + "\n");
        }
        br.close(); fw.close();
    }

    // ================= PRODUCT =================
    static void cleanProducts() throws Exception {
        BufferedReader br = new BufferedReader(new FileReader("legacy_products.csv"));
        FileWriter fw = new FileWriter("clean_products.csv", false);

        fw.write("product_id,shop_id,name,price\n");
        br.readLine();

        String line;
        while ((line = br.readLine()) != null) {
            String[] c = line.split(",");
            if (!shops.contains(c[1])) continue;

            products.add(c[0]);
            fw.write(line + "\n");
        }
        br.close(); fw.close();
    }

    // ================= PRODUCT VARIANT =================
    static void cleanVariants() throws Exception {
        BufferedReader br = new BufferedReader(new FileReader("legacy_product_variants.csv"));
        FileWriter fw = new FileWriter("clean_variants.csv", false);

        fw.write("variant_id,product_id,size,color,stock_quantity\n");
        br.readLine();

        String line;
        while ((line = br.readLine()) != null) {
            String[] c = line.split(",");
            if (!products.contains(c[1])) continue;

            int stock = Math.max(0, Integer.parseInt(c[4]));
            fw.write(c[0] + "," + c[1] + "," + c[2] + "," + c[3] + "," + stock + "\n");
        }
        br.close(); fw.close();
    }

    // ================= VOUCHER =================
    static void cleanVouchers() throws Exception {
        BufferedReader br = new BufferedReader(new FileReader("legacy_vouchers.csv"));
        FileWriter fw = new FileWriter("clean_vouchers.csv", false);
        FileWriter log = new FileWriter("error.log", true);

        fw.write("voucher_id,code,discount_value,min_order_amount,stackable,piority,start_date,end_date\n");
        br.readLine();

        String line;
        while ((line = br.readLine()) != null) {
            String[] c = line.split(",");

            String id = c[0];
            String code = c[1];
            int discount = Integer.parseInt(c[2]);
            int minOrder = Integer.parseInt(c[3]);
            boolean stackable = Boolean.parseBoolean(c[4]);
            int priority = Integer.parseInt(c[5]);
            String start = c[6];
            String end = c[7];

            if (Utils.isEmpty(code)) continue;
            if (!Utils.isValidDate(start) || !Utils.isValidDate(end)) continue;

            LocalDate s = LocalDate.parse(start);
            LocalDate e = LocalDate.parse(end);
            if (!e.isAfter(s)) continue;

            // ğŸ¯ DISCOUNT RULE
            if (stackable) {
                discount = Utils.clamp(discount, 5, 15);
            } else {
                discount = Utils.clamp(discount, 10, 30);
            }

            fw.write(id + "," + code + "," + discount + "," +
                    minOrder + "," + stackable + "," +
                    priority + "," + start + "," + end + "\n");
        }

        br.close(); fw.close(); log.close();
    }
}

ğŸ§  CÃCH GIáº¢I THÃCH (Náº¾U Bá»Š Há»I)

â€œTuáº§n 3 nhÃ³m em thá»±c hiá»‡n data cleaning theo pipeline:
User â†’ Shop â†’ Product â†’ Variant â†’ Voucher,
Ä‘áº£m báº£o toÃ n bá»™ foreign key há»£p lá»‡ trÆ°á»›c khi import database.â€

ğŸ”¥ CÃ¢u nÃ y Äƒn trá»n Ä‘iá»ƒm migration

âœ… Káº¾T QUáº¢ SAU KHI CHáº Y
File	Tráº¡ng thÃ¡i
clean_users.csv	sáº¡ch
clean_shops.csv	FK há»£p lá»‡
clean_products.csv	FK há»£p lá»‡
clean_variants.csv	stock â‰¥ 0
clean_vouchers.csv	Ä‘Ãºng nghiá»‡p vá»¥

Náº¿u báº¡n muá»‘n bÆ°á»›c tiáº¿p:

ğŸ‘‰ Tuáº§n 4: Apply voucher vÃ o Order

ğŸ‘‰ ERD + giáº£i thÃ­ch migration

ğŸ‘‰ Mock váº¥n Ä‘Ã¡p giáº£ng viÃªn

Chá»‰ cáº§n nÃ³i: â€œLÃ m tiáº¿p Tuáº§n 4â€ ğŸ’ª

Ã€ má»™t cÃ¡i ná»¯a, password ko Ä‘c xuáº¥t hiá»‡n mÃ  pháº£i Ä‘c mÃ£ hÃ³a

Chuáº©n ğŸ‘ yÃªu cáº§u nÃ y ráº¥t Ä‘Ãºng chuáº©n thá»±c táº¿ + Äƒn Ä‘iá»ƒm báº£o máº­t.
MÃ¬nh sáº½ chá»‰nh láº¡i TOOL CLEAN Ä‘á»ƒ:

âœ… password KHÃ”NG xuáº¥t hiá»‡n dáº¡ng plain text
âœ… Ä‘Æ°á»£c mÃ£ hÃ³a (hash) trÆ°á»›c khi ghi ra clean_users.csv
âœ… dÃ¹ng SHA-256 (Ä‘á»§ cho LAB211, khÃ´ng quÃ¡ náº·ng nhÆ° BCrypt)

ğŸ” NGUYÃŠN Táº®C TUáº¦N 3 (Báº N NÃŠN NÃ“I)

â€œDá»¯ liá»‡u legacy cÃ³ password dáº¡ng plain text, nhÆ°ng khi migrate sang há»‡ thá»‘ng má»›i thÃ¬ nhÃ³m hash password Ä‘á»ƒ Ä‘áº£m báº£o security.â€

ğŸ‘‰ CÃ¢u nÃ y lÃ  Ä‘iá»ƒm cá»™ng lá»›n

1ï¸âƒ£ Cáº¬P NHáº¬T Utils.java â€“ THÃŠM HÃ€M HASH
import java.security.MessageDigest;

public class Utils {

    public static boolean isEmpty(String s) {
        return s == null || s.trim().isEmpty();
    }

    public static int clamp(int v, int min, int max) {
        return Math.max(min, Math.min(max, v));
    }

    // ğŸ” HASH PASSWORD (SHA-256)
    public static String hashPassword(String password) {
        try {
            MessageDigest md = MessageDigest.getInstance("SHA-256");
            byte[] bytes = md.digest(password.getBytes("UTF-8"));

            StringBuilder sb = new StringBuilder();
            for (byte b : bytes) {
                sb.append(String.format("%02x", b));
            }
            return sb.toString();

        } catch (Exception e) {
            throw new RuntimeException("Password hashing failed");
        }
    }
}

2ï¸âƒ£ Sá»¬A cleanUsers() TRONG CleanAll.java
âŒ CODE CÅ¨ (SAI â€“ plain text)
fw.write(line + "\n");

âœ… CODE Má»šI (ÄÃšNG â€“ HASH PASSWORD)
static void cleanUsers() throws Exception {
    BufferedReader br = new BufferedReader(new FileReader("legacy_users.csv"));
    FileWriter fw = new FileWriter("clean_users.csv", false);

    fw.write("user_id,name,email,password_hash\n");
    br.readLine(); // skip header

    String line;
    while ((line = br.readLine()) != null) {
        String[] c = line.split(",");

        if (Utils.isEmpty(c[1]) || Utils.isEmpty(c[2])) continue;

        String hashedPassword = Utils.hashPassword(c[3]);

        users.add(c[0]);
        fw.write(c[0] + "," + c[1] + "," + c[2] + "," + hashedPassword + "\n");
    }

    br.close();
    fw.close();
}


ğŸ“Œ Äá»•i header thÃ nh password_hash â†’ ráº¥t chuáº©n DB design.

3ï¸âƒ£ Káº¾T QUáº¢ SAU CLEAN
legacy_users.csv
U0001,User 1,user1@gmail.com,123456

clean_users.csv
U0001,User 1,user1@gmail.com,8d969eef6ecad3c29a3a629280e686cf...


âœ” KhÃ´ng lá»™ máº­t kháº©u
âœ” KhÃ´ng thá»ƒ Ä‘áº£o ngÆ°á»£c
âœ” ÄÃºng nghiá»‡p vá»¥ thá»±c táº¿

4ï¸âƒ£ Náº¾U GIáº¢NG VIÃŠN Há»I XOÃY ğŸ˜ˆ

â€œSao khÃ´ng dÃ¹ng BCrypt?â€

ğŸ‘‰ Tráº£ lá»i:

â€œTrong pháº¡m vi LAB211, nhÃ³m dÃ¹ng SHA-256 Ä‘á»ƒ mÃ´ phá»ng hashing. Náº¿u triá»ƒn khai production, nhÃ³m sáº½ dÃ¹ng BCrypt hoáº·c Argon2.â€

ğŸ”¥ CÃ¢u nÃ y cá»±c ká»³ chuyÃªn nghiá»‡p

5ï¸âƒ£ TÃ“M Táº®T CHUáº¨N LAB
Giai Ä‘oáº¡n	Password
Legacy CSV	plain text
Clean CSV	hashed
Database	hashed
Runtime login	compare hash

Náº¿u báº¡n muá»‘n mÃ¬nh:

ğŸ” Hash + salt

ğŸ” Chuyá»ƒn sang BCrypt

ğŸ§ª Viáº¿t code login check password

ğŸ“ Viáº¿t pháº§n Security explanation cho report

ğŸ‘‰ chá»‰ cáº§n nÃ³i: â€œlÃ m tiáº¿p pháº§n securityâ€

Exception in thread "main" java.io.FileNotFoundException: legacy_users.csv (The system cannot find the file specified)
	at java.base/java.io.FileInputStream.open0(Native Method)
	at java.base/java.io.FileInputStream.open(FileInputStream.java:185)
	at java.base/java.io.FileInputStream.<init>(FileInputStream.java:139)
	at java.base/java.io.FileInputStream.<init>(FileInputStream.java:109)
	at java.base/java.io.FileReader.<init>(FileReader.java:60)
	at create.legacy.csv.more.than.pkg10000.lines.CleanAll.cleanUsers(CleanAll.java:27)
	at create.legacy.csv.more.than.pkg10000.lines.CleanAll.main(CleanAll.java:16)
C:\Users\nguye\AppData\Local\NetBeans\Cache\28\executor-snippets\run.xml:111: The following error occurred while executing this line:
C:\Users\nguye\AppData\Local\NetBeans\Cache\28\executor-snippets\run.xml:68: Java returned: 1
BUILD FAILED (total time: 0 seconds)

Lá»—i nÃ y khÃ´ng pháº£i do code, mÃ  do Java khÃ´ng tÃ¬m tháº¥y file CSV á»Ÿ Ä‘Ãºng Ä‘Æ°á»ng dáº«n ğŸ‘
MÃ¬nh giáº£i thÃ­ch + fix chuáº©n NetBeans + LAB211, lÃ m xong lÃ  cháº¡y Ä‘Æ°á»£c ngay.

âŒ NGUYÃŠN NHÃ‚N Lá»–I
FileNotFoundException: legacy_users.csv


ğŸ‘‰ Java Ä‘ang tÃ¬m file á»Ÿ thÆ° má»¥c Ä‘ang cháº¡y chÆ°Æ¡ng trÃ¬nh, nhÆ°ng:

legacy_users.csv khÃ´ng náº±m á»Ÿ Ä‘Ã³

NetBeans cháº¡y file tá»« executor-snippets chá»© khÃ´ng pháº£i thÆ° má»¥c báº¡n nghÄ©

âœ… CÃCH FIX 1 (KHUYáº¾N NGHá»Š â€“ Dá»„ NHáº¤T)
ğŸ”¹ BÆ¯á»šC 1: Táº O THÆ¯ Má»¤C data/

Trong project NetBeans:

Project
â”œâ”€â”€ src/
â”‚   â””â”€â”€ create/legacy/csv/...
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ legacy_users.csv
â”‚   â”œâ”€â”€ legacy_shops.csv
â”‚   â”œâ”€â”€ legacy_products.csv
â”‚   â”œâ”€â”€ legacy_product_variants.csv
â”‚   â””â”€â”€ legacy_vouchers.csv

ğŸ”¹ BÆ¯á»šC 2: Sá»¬A ÄÆ¯á»œNG DáºªN TRONG CODE

âŒ Sai

new FileReader("legacy_users.csv")


âœ… ÄÃºng

new FileReader("data/legacy_users.csv")


ğŸ‘‰ Sá»­a cho táº¥t cáº£ file:

new FileReader("data/legacy_users.csv")
new FileReader("data/legacy_shops.csv")
new FileReader("data/legacy_products.csv")
new FileReader("data/legacy_product_variants.csv")
new FileReader("data/legacy_vouchers.csv")

âœ… CÃCH FIX 2 (ÄÃšNG Ká»¸ THUáº¬T HÆ N â€“ DÃ™NG PATH CHUNG)
ğŸ”¹ THÃŠM BIáº¾N Gá»C

Trong CleanAll.java:

static final String DATA_DIR = "data/";


Sau Ä‘Ã³:

new FileReader(DATA_DIR + "legacy_users.csv")


ğŸ‘‰ Code khÃ´ng bá»‹ hard-code linh tinh

âœ… CÃCH FIX 3 (CHUáº¨N CHUYÃŠN NGHIá»†P â€“ DEBUG)

ThÃªm dÃ²ng nÃ y vÃ o main():

System.out.println("Running at: " + new File(".").getAbsolutePath());


ğŸ‘‰ Java sáº½ in ra thÆ° má»¥c Ä‘ang cháº¡y, báº¡n sáº½ biáº¿t nÃ³ tÃ¬m file á»Ÿ Ä‘Ã¢u

âš ï¸ CÃCH KHÃ”NG NÃŠN DÃ™NG

âŒ ÄÆ°á»ng dáº«n kiá»ƒu:

"C:\\Users\\nguye\\Desktop\\legacy_users.csv"


â†’ máº¥t Ä‘iá»ƒm vÃ¬ hard-code mÃ¡y cÃ¡ nhÃ¢n

ğŸ§  CÃ‚U TRáº¢ Lá»œI KHI Bá»Š Há»I

â€œNhÃ³m Ä‘áº·t cÃ¡c file legacy trong thÆ° má»¥c data/ vÃ  dÃ¹ng relative path Ä‘á»ƒ Ä‘áº£m báº£o code cháº¡y Ä‘Æ°á»£c trÃªn má»i mÃ¡y.â€

ğŸ”¥ CÃ¢u nÃ y Äƒn Ä‘iá»ƒm portability

âœ… CHECKLIST NHANH

âœ” CÃ³ thÆ° má»¥c data/
âœ” File CSV náº±m trong Ä‘Ã³
âœ” Sá»­a Ä‘Ãºng path
âœ” Run láº¡i CleanAll

Náº¿u báº¡n muá»‘n, mÃ¬nh cÃ³ thá»ƒ:

ğŸ“‚ Táº¡o sáºµn cáº¥u trÃºc project NetBeans

ğŸ§ª Viáº¿t code auto táº¡o thÆ° má»¥c

ğŸ“ Viáº¿t pháº§n Tuáº§n 3 Report â€“ Data Cleaning

ğŸ‘‰ chá»‰ cáº§n nÃ³i: â€œlÃ m report tuáº§n 3â€

package create.legacy.csv.more.than.pkg10000.lines;

import java.io.*;
import java.time.LocalDate;
import java.util.*;

public class CleanAll {

    static Set<String> users = new HashSet<>();
    static Set<String> shops = new HashSet<>();
    static Set<String> products = new HashSet<>();

    static Random random = new Random();

    public static void main(String[] args) throws Exception {
        cleanUsers();
        cleanShops();
        cleanProducts();
        cleanVariants();
        cleanVouchers();

        System.out.println("âœ… DONE: All clean CSV generated");
    }

    // ================= USER =================
    static void cleanUsers() throws Exception {
    BufferedReader br = new BufferedReader(new FileReader("clean_users.csv"));
    FileWriter fw = new FileWriter("clean_users.csv", false);

    fw.write("user_id,name,email,password_hash\n");
    br.readLine(); // skip header

    String line;
    while ((line = br.readLine()) != null) {
        String[] c = line.split(",");

        if (Utils.isEmpty(c[1]) || Utils.isEmpty(c[2])) continue;

        String hashedPassword = Utils.hashPassword(c[3]);

        users.add(c[0]);
        fw.write(c[0] + "," + c[1] + "," + c[2] + "," + hashedPassword + "\n");
    }

    br.close();
    fw.close();
}


    // ================= SHOP =================
    static void cleanShops() throws Exception {
        BufferedReader br = new BufferedReader(new FileReader("clean_shops.csv"));
        FileWriter fw = new FileWriter("clean_shops.csv", false);

        fw.write("shop_id,shop_name,owner_id\n");
        br.readLine();

        String line;
        while ((line = br.readLine()) != null) {
            String[] c = line.split(",");
            if (!users.contains(c[2])) continue;

            shops.add(c[0]);
            fw.write(line + "\n");
        }
        br.close(); fw.close();
    }

    // ================= PRODUCT =================
    static void cleanProducts() throws Exception {
        BufferedReader br = new BufferedReader(new FileReader("clean_products.csv"));
        FileWriter fw = new FileWriter("clean_products.csv", false);

        fw.write("product_id,shop_id,name,price\n");
        br.readLine();

        String line;
        while ((line = br.readLine()) != null) {
            String[] c = line.split(",");
            if (!shops.contains(c[1])) continue;

            products.add(c[0]);
            fw.write(line + "\n");
        }
        br.close(); fw.close();
    }

    // ================= PRODUCT VARIANT =================
    static void cleanVariants() throws Exception {
        BufferedReader br = new BufferedReader(new FileReader("clean_variants.csv"));
        FileWriter fw = new FileWriter("clean_variants.csv", false);

        fw.write("variant_id,product_id,size,color,stock_quantity\n");
        br.readLine();

        String line;
        while ((line = br.readLine()) != null) {
            String[] c = line.split(",");
            if (!products.contains(c[1])) continue;

            int stock = Math.max(0, Integer.parseInt(c[4]));
            fw.write(c[0] + "," + c[1] + "," + c[2] + "," + c[3] + "," + stock + "\n");
        }
        br.close(); fw.close();
    }

    // ================= VOUCHER =================
    static void cleanVouchers() throws Exception {
        BufferedReader br = new BufferedReader(new FileReader("clean_vouchers.csv"));
        FileWriter fw = new FileWriter("clean_vouchers.csv", false);
        FileWriter log = new FileWriter("error.log", true);

        fw.write("voucher_id,code,discount_value,min_order_amount,stackable,piority,start_date,end_date\n");
        br.readLine();

        String line;
        while ((line = br.readLine()) != null) {
            String[] c = line.split(",");

            String id = c[0];
            String code = c[1];
            int discount = Integer.parseInt(c[2]);
            int minOrder = Integer.parseInt(c[3]);
            boolean stackable = Boolean.parseBoolean(c[4]);
            int priority = Integer.parseInt(c[5]);
            String start = c[6];
            String end = c[7];

            if (Utils.isEmpty(code)) continue;
            if (!Utils.isValidDate(start) || !Utils.isValidDate(end)) continue;

            LocalDate s = LocalDate.parse(start);
            LocalDate e = LocalDate.parse(end);
            if (!e.isAfter(s)) continue;

            // ğŸ¯ DISCOUNT RULE
            if (stackable) {
                discount = Utils.clamp(discount, 5, 15);
            } else {
                discount = Utils.clamp(discount, 10, 30);
            }

        }
    }
}
    sao nÃ³ ko táº¡o j cáº£ 

Báº¡n gáº·p 3 lá»—i logic ráº¥t nghiÃªm trá»ng, nÃªn chÆ°Æ¡ng trÃ¬nh cháº¡y nhÆ°ng khÃ´ng táº¡o ra gÃ¬ cáº£.
MÃ¬nh chá»‰ ra Ä‘Ãºng chá»— sai â†’ sá»­a Ä‘Ãºng chuáº©n Tuáº§n 3 cho báº¡n.

âŒ VÃŒ SAO â€œKHÃ”NG Táº O GÃŒ Cáº¢â€?
ğŸš¨ Lá»–I 1 â€” Äá»ŒC NHáº¦M FILE (Lá»–I Náº¶NG NHáº¤T)

Báº¡n Ä‘ang clean nhÆ°ng láº¡i Ä‘á»c file clean ğŸ¤¯

VÃ­ dá»¥:

BufferedReader br = new BufferedReader(new FileReader("clean_users.csv"));
FileWriter fw = new FileWriter("clean_users.csv", false);


ğŸ‘‰ NghÄ©a lÃ :

Báº¡n má»Ÿ clean_users.csv Ä‘á»ƒ Ä‘á»c

Ngay sau Ä‘Ã³ xÃ³a sáº¡ch nÃ³ Ä‘á»ƒ ghi

â†’ File rá»—ng â†’ khÃ´ng cÃ³ dÃ²ng nÃ o Ä‘á»ƒ while Ä‘á»c

ğŸ“Œ ÄÃšNG PHáº¢I LÃ€:

Äá»c legacy_*.csv

Ghi ra clean_*.csv

ğŸš¨ Lá»–I 2 â€” VOUCHER KHÃ”NG GHI RA FILE

Trong cleanVouchers() báº¡n KHÃ”NG cÃ³ dÃ²ng fw.write(...)

ğŸ‘‰ Code chá»‰ validate xong rá»“iâ€¦ bá» luÃ´n

ğŸš¨ Lá»–I 3 â€” THIáº¾U Utils.isValidDate() TRONG Utils

Báº¡n gá»i:

Utils.isValidDate(start)


NhÆ°ng Utils báº¡n gá»­i trÆ°á»›c Ä‘Ã³ KHÃ”NG cÃ³ hÃ m nÃ y
â†’ Náº¿u compile Ä‘Æ°á»£c thÃ¬ lÃ  do NetBeans cache, nhÆ°ng logic váº«n sai.

âœ… CODE ÄÃšNG â€“ MÃŒNH FIX TOÃ€N Bá»˜ CHO Báº N
ğŸ”§ NGUYÃŠN Táº®C CHUáº¨N
Äá»c	Ghi
legacy_users.csv	clean_users.csv
legacy_shops.csv	clean_shops.csv
legacy_products.csv	clean_products.csv
legacy_product_variants.csv	clean_variants.csv
legacy_vouchers.csv	clean_vouchers.csv
1ï¸âƒ£ Utils.java (Äáº¦Y Äá»¦ â€“ Äá»ªNG THIáº¾U)
import java.security.MessageDigest;
import java.time.LocalDate;

public class Utils {

    public static boolean isEmpty(String s) {
        return s == null || s.trim().isEmpty();
    }

    public static boolean isValidDate(String d) {
        try {
            LocalDate.parse(d);
            return true;
        } catch (Exception e) {
            return false;
        }
    }

    public static int clamp(int v, int min, int max) {
        return Math.max(min, Math.min(max, v));
    }

    public static String hashPassword(String password) {
        try {
            MessageDigest md = MessageDigest.getInstance("SHA-256");
            byte[] b = md.digest(password.getBytes("UTF-8"));
            StringBuilder sb = new StringBuilder();
            for (byte x : b) sb.append(String.format("%02x", x));
            return sb.toString();
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}

2ï¸âƒ£ CleanAll.java (FIX ÄÃšNG â€“ CHáº Y LÃ€ RA FILE)
ğŸ”¹ USER
static void cleanUsers() throws Exception {
    BufferedReader br = new BufferedReader(new FileReader("legacy_users.csv"));
    FileWriter fw = new FileWriter("clean_users.csv");

    fw.write("user_id,name,email,password_hash\n");
    br.readLine();

    String line;
    while ((line = br.readLine()) != null) {
        String[] c = line.split(",");
        if (Utils.isEmpty(c[1]) || Utils.isEmpty(c[2])) continue;

        users.add(c[0]);
        fw.write(c[0] + "," + c[1] + "," + c[2] + "," +
                 Utils.hashPassword(c[3]) + "\n");
    }
    br.close(); fw.close();
}

ğŸ”¹ SHOP
static void cleanShops() throws Exception {
    BufferedReader br = new BufferedReader(new FileReader("legacy_shops.csv"));
    FileWriter fw = new FileWriter("clean_shops.csv");

    fw.write("shop_id,shop_name,owner_id\n");
    br.readLine();

    String line;
    while ((line = br.readLine()) != null) {
        String[] c = line.split(",");
        if (!users.contains(c[2])) continue;

        shops.add(c[0]);
        fw.write(line + "\n");
    }
    br.close(); fw.close();
}

ğŸ”¹ PRODUCT
static void cleanProducts() throws Exception {
    BufferedReader br = new BufferedReader(new FileReader("legacy_products.csv"));
    FileWriter fw = new FileWriter("clean_products.csv");

    fw.write("product_id,shop_id,name,price\n");
    br.readLine();

    String line;
    while ((line = br.readLine()) != null) {
        String[] c = line.split(",");
        if (!shops.contains(c[1])) continue;

        products.add(c[0]);
        fw.write(line + "\n");
    }
    br.close(); fw.close();
}

ğŸ”¹ PRODUCT VARIANT
static void cleanVariants() throws Exception {
    BufferedReader br = new BufferedReader(new FileReader("legacy_product_variants.csv"));
    FileWriter fw = new FileWriter("clean_variants.csv");

    fw.write("variant_id,product_id,size,color,stock_quantity\n");
    br.readLine();

    String line;
    while ((line = br.readLine()) != null) {
        String[] c = line.split(",");
        if (!products.contains(c[1])) continue;

        int stock = Math.max(0, Integer.parseInt(c[4]));
        fw.write(c[0] + "," + c[1] + "," + c[2] + "," + c[3] + "," + stock + "\n");
    }
    br.close(); fw.close();
}

ğŸ”¹ VOUCHER (Báº N THIáº¾U fw.write)
static void cleanVouchers() throws Exception {
    BufferedReader br = new BufferedReader(new FileReader("legacy_vouchers.csv"));
    FileWriter fw = new FileWriter("clean_vouchers.csv");

    fw.write("voucher_id,code,discount_value,min_order_amount,stackable,piority,start_date,end_date\n");
    br.readLine();

    String line;
    while ((line = br.readLine()) != null) {
        String[] c = line.split(",");

        if (Utils.isEmpty(c[1])) continue;
        if (!Utils.isValidDate(c[6]) || !Utils.isValidDate(c[7])) continue;
        if (!LocalDate.parse(c[7]).isAfter(LocalDate.parse(c[6]))) continue;

        int discount = Integer.parseInt(c[2]);
        boolean stackable = Boolean.parseBoolean(c[4]);

        discount = stackable
                ? Utils.clamp(discount, 5, 15)
                : Utils.clamp(discount, 10, 30);

        fw.write(c[0] + "," + c[1] + "," + discount + "," +
                 c[3] + "," + stackable + "," +
                 c[5] + "," + c[6] + "," + c[7] + "\n");
    }
    br.close(); fw.close();
}

ğŸ§  TÃ“M Táº®T NGáº®N Gá»ŒN (NÃŠN NHá»š)

âŒ Äá»c clean â†’ ghi clean â†’ file rá»—ng
âŒ Validate xong khÃ´ng fw.write â†’ khÃ´ng cÃ³ output

âœ… LuÃ´n: legacy â†’ clean
âœ… Validate xong pháº£i ghi

Náº¿u báº¡n muá»‘n, mÃ¬nh cÃ³ thá»ƒ:

âœ… Váº½ flow Migration Tuáº§n 3

âœ… Viáº¿t Ä‘oáº¡n giáº£i thÃ­ch váº¥n Ä‘Ã¡p

âœ… LÃ m tiáº¿p Tuáº§n 4 (Order + Voucher)

ğŸ‘‰ Chá»‰ cáº§n nÃ³i: â€œGiáº£i thÃ­ch váº¥n Ä‘Ã¡p Tuáº§n 3â€
